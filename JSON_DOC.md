# LDtk Json structure (version 0.6.0-beta)
Please refer to the [README.md](https://github.com/deepnight/ldtk/blob/master/README.md) for more informations.
   - [LDtk Json root](#ldtk-ProjectJson)
   - [Level](#ldtk-LevelJson)
     - [Layer instance](#ldtk-LayerInstanceJson)
       - [Tile instance](#ldtk-Tile)
       - [Entity instance](#ldtk-EntityInstanceJson)
       - [Field instance](#ldtk-FieldInstanceJson)
   - [Definitions](#ldtk-DefinitionsJson)
     - [Layer definition](#ldtk-LayerDefJson)
       - [Auto-layer rule definition](#ldtk-AutoRuleDef)
     - [Entity definition](#ldtk-EntityDefJson)
       - [Field definition](#ldtk-FieldDefJson)
     - [Tileset definition](#ldtk-TilesetDefJson)
     - [Enum definition](#ldtk-EnumDefJson)

<a id="ldtk-ProjectJson" name="ldtk-ProjectJson"></a>
## LDtk Json root   
Value | Type | Description
-- | -- | --
`bgColor` | String | Project background color
`defaultGridSize` | Int | Default grid size for new layers
`defaultPivotX` | Float | Default X pivot (0 to 1) for new entities
`defaultPivotY` | Float | Default Y pivot (0 to 1) for new entities
`defs` | [Definitions](#ldtk-DefinitionsJson) | A structure containing all the definitions of this project
`exportTiled` | Bool | If TRUE, a Tiled compatible file will also be generated along with the LDtk JSON file (default is FALSE)
`jsonVersion` | String | File format version
`levels` | Array&nbsp;of&nbsp;[Level](#ldtk-LevelJson) | 
`minifyJson` | Bool | If TRUE, the Json is partially minified (no indentation, nor line breaks, default is FALSE)

<a id="ldtk-LevelJson" name="ldtk-LevelJson"></a>
## 1. Level   
Value | Type | Description
-- | -- | --
`identifier` | String | Unique String identifier
`layerInstances` | Array&nbsp;of&nbsp;[Layer&nbsp;instance](#ldtk-LayerInstanceJson) | 
`pxHei` | Int | Height of the level in pixels
`pxWid` | Int | Width of the level in pixels
`uid` | Int | Unique Int identifier
`worldX`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.6.0-green.svg)  | Int | World X coordinate in pixels
`worldY`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.6.0-green.svg)  | Int | World Y coordinate in pixels

<a id="ldtk-LayerInstanceJson" name="ldtk-LayerInstanceJson"></a>
## 1.1. Layer instance   
Value | Type | Description
-- | -- | --
`__cHei` | Int | Grid-based height
`__cWid` | Int | Grid-based width
`__gridSize` | Int | Grid size
`__identifier` | String | Unique String identifier
`__opacity`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.4.0-gray.svg)  | Float | Layer opacity as Float [0-1]
`__pxTotalOffsetX`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.5.0-gray.svg)  | Int | Total layer X pixel offset, including both instance and definition offsets.
`__pxTotalOffsetY`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.5.0-gray.svg)  | Int | Total layer Y pixel offset, including both instance and definition offsets.
`__type` | String | Layer type (possible values: IntGrid, Entities, Tiles or AutoLayer)
`autoLayerTiles`<br/><sup>Only *Auto-layers*</sup><br/> ![Generic badge](https://img.shields.io/badge/Added_0.4.0-gray.svg)  | Array&nbsp;of&nbsp;[Tile&nbsp;instance](#ldtk-Tile) | An array containing all tiles generated by Auto-layer rules. The array is already sorted in display order (ie. 1st tile is beneath 2nd, which is beneath 3rd etc.).<br/><br/>		Note: if multiple tiles are stacked in the same cell as the result of different rules, all tiles behind opaque ones will be discarded.
`entityInstances`<br/><sup>Only *Entity layers*</sup> | Array&nbsp;of&nbsp;[Entity&nbsp;instance](#ldtk-EntityInstanceJson) | 
`gridTiles`<br/><sup>Only *Tile layers*</sup> | Array&nbsp;of&nbsp;[Tile&nbsp;instance](#ldtk-Tile) | 
`intGrid`<br/><sup>Only *IntGrid layers*</sup> | Array&nbsp;of&nbsp;Object | This object contains the following fields:<br/><ul><li>**`coordId`** **(Int**) : *Coordinate ID in the layer grid*</li><li>**`v`** **(Int**) : *IntGrid value*</li></ul>
`layerDefUid` | Int | Reference the Layer definition UID
`levelId` | Int | Reference to the UID of the level containing this layer instance
`pxOffsetX`<br/> ![Generic badge](https://img.shields.io/badge/Changed_0.5.0-gray.svg)  | Int | X offset in pixels to render this layer, usually 0 (IMPORTANT: this should be added to the `LayerDef` optional offset)
`pxOffsetY`<br/> ![Generic badge](https://img.shields.io/badge/Changed_0.5.0-gray.svg)  | Int | Y offset in pixels to render this layer, usually 0 (IMPORTANT: this should be added to the `LayerDef` optional offset)
`seed`<br/><sup>Only *Auto-layers*</sup> | Int | Random seed used for Auto-Layers rendering

<a id="ldtk-Tile" name="ldtk-Tile"></a>
## 1.1.1. Tile instance  ![Generic badge](https://img.shields.io/badge/Added_0.4.0-gray.svg) 
Value | Type | Description
-- | -- | --
`d`<br/> ![Generic badge](https://img.shields.io/badge/Changed_0.6.0-green.svg)  | Array&nbsp;of&nbsp;Int | Internal data used by the editor.<br/>		For auto-layer tiles: `[ruleId, coordId]`.<br/>		For tile-layer tiles: `[coordId]`.
`f` | Int | "Flip bits", a 2-bits integer to represent the mirror transformations of the tile.<br/>		 - Bit 0 = X flip<br/>		 - Bit 1 = Y flip<br/>		 Examples: f=0 (no flip), f=1 (X flip only), f=2 (Y flip only), f=3 (both flips)
`px`<br/> ![Generic badge](https://img.shields.io/badge/Changed_0.5.0-gray.svg)  | Array&nbsp;of&nbsp;Int | Pixel coordinates of the tile in the **layer** (`[x,y]` format). Don't forget optional layer offsets, if they exist!
`src` | Array&nbsp;of&nbsp;Int | Pixel coordinates of the tile in the **tileset** (`[x,y]` format)
`t`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.6.0-green.svg)  | Int | The *Tile ID* in the corresponding tileset.

<a id="ldtk-EntityInstanceJson" name="ldtk-EntityInstanceJson"></a>
## 1.1.2. Entity instance   
Value | Type | Description
-- | -- | --
`__grid`<br/> ![Generic badge](https://img.shields.io/badge/Changed_0.4.0-gray.svg)  | Array&nbsp;of&nbsp;Int | Grid-based coordinates (`[x,y]` format)
`__identifier` | String | Unique String identifier
`__tile`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.4.0-gray.svg)  | Object&nbsp;*(can&nbsp;be&nbsp;`null`)* | Optional Tile used to display this entity (it could either be the default Entity tile, or some tile provided by a field value, like an Enum).<br/>This object contains the following fields:<br/><ul><li>**`srcRect`** **(Array of Int**) : *An array of 4 Int values that refers to the tile in the tileset image: `[ x, y, width, height ]`*</li><li>**`tilesetUid`** **(Int**) : *Tileset ID*</li></ul>
`defUid` | Int | Reference of the **Entity definition** UID
`fieldInstances` | Array&nbsp;of&nbsp;[Field&nbsp;instance](#ldtk-FieldInstanceJson) | 
`px`<br/> ![Generic badge](https://img.shields.io/badge/Changed_0.4.0-gray.svg)  | Array&nbsp;of&nbsp;Int | Pixel coordinates (`[x,y]` format). Don't forget optional layer offsets, if they exist!

<a id="ldtk-FieldInstanceJson" name="ldtk-FieldInstanceJson"></a>
## 1.1.3. Field instance   
Value | Type | Description
-- | -- | --
`__identifier` | String | Unique String identifier
`__type` | String | Type of the field, such as Int, Float, Enum(enum_name), Bool, etc.
`__value` | Dynamic&nbsp;(anything) | Actual value of the field instance. The value type may vary, depending on `__type` (Integer, Boolean, String etc.)<br/>		It can also be an `Array` of various types.
`defUid` | Int | Reference of the **Field definition** UID

<a id="ldtk-DefinitionsJson" name="ldtk-DefinitionsJson"></a>
## 2. Definitions   
Value | Type | Description
-- | -- | --
`entities` | Array&nbsp;of&nbsp;[Entity&nbsp;definition](#ldtk-EntityDefJson) | 
`enums` | Array&nbsp;of&nbsp;[Enum&nbsp;definition](#ldtk-EnumDefJson) | 
`externalEnums` | Array&nbsp;of&nbsp;[Enum&nbsp;definition](#ldtk-EnumDefJson) | Note: external enums are exactly the same as `enums`, except they<br/>		have a `relPath` to point to an external source file.
`layers` | Array&nbsp;of&nbsp;[Layer&nbsp;definition](#ldtk-LayerDefJson) | 
`tilesets` | Array&nbsp;of&nbsp;[Tileset&nbsp;definition](#ldtk-TilesetDefJson) | 

<a id="ldtk-LayerDefJson" name="ldtk-LayerDefJson"></a>
## 2.1. Layer definition   
Value | Type | Description
-- | -- | --
`__type` | String | Type of the layer (*IntGrid, Entities, Tiles or AutoLayer*)
`autoRuleGroups`<br/><sup>Only *Auto-layers*</sup> | Array&nbsp;of&nbsp;Object | Contains all the auto-layer rule definitions.<br/>This object contains the following fields:<br/><ul><li>**`active`** **(Bool**)</li><li>**`collapsed`** **(Bool**)</li><li>**`name`** **(String**)</li><li>**`rules`** **(Array of [Auto-layer rule definition](#ldtk-AutoRuleDef)**)</li><li>**`uid`** **(Int**)</li></ul>
`autoSourceLayerDefUid`<br/><sup>Only *Auto-layers*</sup> | Int | 
`autoTilesetDefUid`<br/><sup>Only *Auto-layers*</sup> | Int | Reference to the Tileset UID being used by this auto-layer rules
`displayOpacity` | Float | Opacity of the layer (0 to 1.0)
`gridSize` | Int | Width and height of the grid in pixels
`identifier` | String | Unique String identifier
`intGridValues`<br/><sup>Only *IntGrid layer*</sup> | Array&nbsp;of&nbsp;Object | This object contains the following fields:<br/><ul><li>**`color`** **(String**) *Hex color "#rrggbb"*</li><li>**`identifier`** **(String**)</li></ul>
`pxOffsetX`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.5.0-gray.svg)  | Int | X offset of the layer, in pixels (IMPORTANT: this should be added to the `LayerInstance` optional offset)
`pxOffsetY`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.5.0-gray.svg)  | Int | Y offset of the layer, in pixels (IMPORTANT: this should be added to the `LayerInstance` optional offset)
`tilePivotX`<br/><sup>Only *Tile layers*</sup> | Float | If the tiles are smaller or larger than the layer grid, the pivot value will be used to position the tile relatively its grid cell.
`tilePivotY`<br/><sup>Only *Tile layers*</sup> | Float | If the tiles are smaller or larger than the layer grid, the pivot value will be used to position the tile relatively its grid cell.
`tilesetDefUid`<br/><sup>Only *Tile layers*</sup> | Int | Reference to the Tileset UID being used by this tile layer
`uid` | Int | Unique Int identifier

<a id="ldtk-AutoRuleDef" name="ldtk-AutoRuleDef"></a>
## 2.1.1. Auto-layer rule definition   
Value | Type | Description
-- | -- | --
`active` | Bool | If FALSE, the rule effect isn't applied, and no tiles are generated.
`breakOnMatch` | Bool | When TRUE, the rule will prevent other rules to be applied in the same cell if it matches (TRUE by default).
`chance` | Float | Chances for this rule to be applied (0 to 1)
`checker` | Bool | If TRUE, enable checker mode
`flipX` | Bool | If TRUE, allow rule to be matched by flipping its pattern horizontally
`flipY` | Bool | If TRUE, allow rule to be matched by flipping its pattern vertically
`pattern` | Array&nbsp;of&nbsp;Int | Rule pattern (size x size)
`perlinActive` | Bool | If TRUE, enable Perlin filtering to only apply rule on specific random area
`perlinOctaves` | Float | 
`perlinScale` | Float | 
`perlinSeed` | Float | 
`pivotX`<br/><sup>Only *'Stamp' tile mode*</sup> | Float | X pivot of a tile stamp (0-1)
`pivotY`<br/><sup>Only *'Stamp' tile mode*</sup> | Float | Y pivot of a tile stamp (0-1)
`size` | Int | <![CDATA[Pattern width & height. Should only be 1,3,5 or 7.]]>
`tileIds` | Array&nbsp;of&nbsp;Int | Array of all the tile IDs. They are used randomly or as stamps, based on `tileMode` value.
`tileMode` | Enum | Defines how tileIds array is used
`uid` | Int | Unique Int identifier
`xModulo` | Int | X cell coord modulo
`yModulo` | Int | Y cell coord modulo

<a id="ldtk-EntityDefJson" name="ldtk-EntityDefJson"></a>
## 2.2. Entity definition   
Value | Type | Description
-- | -- | --
`color` | String | Base entity color
`fieldDefs` | Array&nbsp;of&nbsp;[Field&nbsp;definition](#ldtk-FieldDefJson) | Array of field definitions
`height` | Int | Pixel height
`identifier` | String | Unique String identifier
`maxPerLevel` | Int | Max instances per level
`pivotX` | Float | Pivot X coordinate (from 0 to 1.0)
`pivotY` | Float | Pivot Y coordinate (from 0 to 1.0)
`tileId` | Int | Tile ID used for optional tile display
`tilesetId` | Int | Tileset ID used for optional tile display
`uid` | Int | Unique Int identifier
`width` | Int | Pixel width

<a id="ldtk-FieldDefJson" name="ldtk-FieldDefJson"></a>
## 2.2.1. Field definition   
Sorry this type has no documentation yet.

<a id="ldtk-TilesetDefJson" name="ldtk-TilesetDefJson"></a>
## 2.3. Tileset definition   
Value | Type | Description
-- | -- | --
`cachedPixelData`<br/> ![Generic badge](https://img.shields.io/badge/Added_0.6.0-green.svg)  | Object&nbsp;*(can&nbsp;be&nbsp;`null`)* | The following data is used internally for various optimizations. It's always synced with source image changes.<br/>This object contains the following fields:<br/><ul><li>**`averageColors`** **(String *(can be `null`)***)  ![Generic badge](https://img.shields.io/badge/Added_0.6.0-green.svg)  : *Average color codes for each tileset tile (ARGB format)*</li><li>**`opaqueTiles`** **(String**)  ![Generic badge](https://img.shields.io/badge/Changed_0.6.0-green.svg)  : *An array of 0/1 bytes, encoded in Base64, that tells if a specific TileID is fully opaque (1) or not (0)*</li></ul>
`identifier` | String | Unique String identifier
`padding` | Int | Distance in pixels from image borders
`pxHei` | Int | Image width in pixels
`pxWid` | Int | Image width in pixels
`relPath` | String | Path to the source file, relative to the current project JSON file
`spacing` | Int | Space in pixels between all tiles
`tileGridSize` | Int | 
`uid` | Int | Unique Intidentifier

<a id="ldtk-EnumDefJson" name="ldtk-EnumDefJson"></a>
## 2.4. Enum definition   
Value | Type | Description
-- | -- | --
`externalRelPath` | String&nbsp;*(can&nbsp;be&nbsp;`null`)* | Relative path to the external file providing this Enum
`iconTilesetUid` | Int&nbsp;*(can&nbsp;be&nbsp;`null`)* | Tileset UID if provided
`identifier` | String | Unique String identifier
`uid` | Int | Unique Int identifier
`values` | Array&nbsp;of&nbsp;Object | All possible enum values, with their optional Tile infos.<br/>This object contains the following fields:<br/><ul><li>**`__tileSrcRect`** **(Array of Int**)  ![Generic badge](https://img.shields.io/badge/Added_0.4.0-gray.svg)  : *An array of 4 Int values that refers to the tile in the tileset image: `[ x, y, width, height ]`*</li><li>**`id`** **(String**) : *Enum value*</li><li>**`tileId`** **(Int *(can be `null`)***) : *The optional ID of the tile*</li></ul>